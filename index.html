function exportToPDF() {
  if (userSchedule.length === 0) {
    alert('Your schedule is empty. Please add some exams before exporting. / جدولك فارغ. يرجى إضافة بعض الامتحانات قبل التصدير.');
    return;
  }

  // Initialize jsPDF
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // Add English-only header
  doc.setFillColor(67, 97, 238);
  doc.rect(0, 0, 210, 30, 'F');
  doc.setTextColor(255, 255, 255);
  doc.setFontSize(20);
  doc.setFont('helvetica', 'bold');
  doc.text('Midterm Exam Schedule', 105, 15, { align: 'center' });
  
  // Add date (English only)
  doc.setFontSize(10);
  const today = new Date();
  doc.text(`Generated on: ${today.toLocaleDateString('en-US', { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric',
    weekday: 'long'
  })}`, 105, 25, { align: 'center' });

  // Prepare English-only table data
  const headers = [['Date', 'Time', 'Subject', 'Code', 'Section', 'Instructor']];
  const data = userSchedule.map(exam => [
    formatDateForPDF(exam.date),
    exam.time,
    exam.subject,
    exam.code,
    exam.section,
    exam.teacher
  ]);

  // Add table
  doc.autoTable({
    head: headers,
    body: data,
    startY: 35,
    theme: 'grid',
    headStyles: {
      fillColor: [67, 97, 238],
      textColor: 255,
      fontStyle: 'bold'
    },
    alternateRowStyles: {
      fillColor: [245, 247, 250]
    },
    styles: {
      fontSize: 9,
      cellPadding: 3,
      overflow: 'linebreak'
    },
    columnStyles: {
      0: { cellWidth: 25 },
      1: { cellWidth: 25 },
      2: { cellWidth: 60 },
      3: { cellWidth: 20 },
      4: { cellWidth: 20 },
      5: { cellWidth: 40 }
    },
    margin: { top: 35 }
  });

  // Add English-only footer
  const pageCount = doc.internal.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(8);
    doc.setTextColor(150);
    doc.text(`Page ${i} of ${pageCount}`, 105, 285, { align: 'center' });
    doc.text('Generated by Midterm Schedule Builder', 105, 290, { align: 'center' });
  }

  // Show notification
  showNotification();

  // Save the PDF
  doc.save('midterm_schedule.pdf');
}

function formatDateForPDF(dateString) {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', { 
    weekday: 'short', 
    month: 'short', 
    day: 'numeric' 
  });
}
